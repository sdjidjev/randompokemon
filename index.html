<!DOCTYPE html>
<html ng-app>
	<head>
		 <link rel="icon" href="favicon.ico" type="image/x-icon">
		<link href='http://fonts.googleapis.com/css?family=Merriweather+Sans:400,300' rel='stylesheet' type='text/css'>
		<link href='http://fonts.googleapis.com/css?family=Niconne' rel='stylesheet' type='text/css'>
		<title>Random Pokemon! </title>
		<link href="index.css" type = "text/css" rel = "stylesheet">

		<script type="text/javascript" src="./angular.min.js"></script>

		<script>
			function pokemans($scope) {
				$scope.text = "Wow. A Pokemon appeared! Wow.";

				$scope.getRandomPokemon = function() {
					var num = Math.floor(Math.random() * 649) + 1;
					if (num < 10) {
						num = '00' + String(num);
					} else if (num < 100) {
						num = '0' + String(num);
					}

					var pokemon_dict = window.localStorage.getItem('pokemans');
					if (!pokemon_dict) {
						pokemon_dict = new Array(649).join("0");
					}
					var num2 = Number(num)-1;
					pokemon_dict = pokemon_dict.substring(0, num2) + '1' + pokemon_dict.substring(num2+1);
					window.localStorage.setItem('pokemans', pokemon_dict);

					console.log(num);
					return num;
				};

				$scope.isShiny = function(){
					var num = Math.floor(Math.random()*1000);
					var str = "";
					if (num == 2 || num == 1){
						return true;
					}
					else{
						return false
					}
				};

				$scope.isWinner = function() {
					var pokemon_dict = window.localStorage.getItem('pokemans');
					if (pokemon_dict.indexOf("0") == -1) {
						return true;
					} else {
						return false;
					}
				}

				$scope.reset = function(){
					window.localStorage.setItem('pokemans', new Array(649).join("0"));
					$scope.winner = $scope.isWinner();
				}

				$scope.update = function() {
					$scope.pokemontype = "i"
					$scope.num = $scope.getRandomPokemon();
					$scope.shiny = $scope.isShiny();
					$scope.winner = $scope.isWinner();
					if ($scope.shiny) {
						$scope.pokemontype = "s";
					}
				};

				$scope.update();
			}
		</script>

	</head>
	
	<body>

		<div ng-controller="pokemans" align=center>

			<div>{{text}}</div>
			<div><img ng-src="http://sprites.pokecheck.org/{{pokemontype}}/{{num}}.gif" height="150px"></img></div>
			<div ng-show="shiny">look is a shiny</div>
			<div ng-show="winner">a winner is u</div>
			<button ng-click="update()">new</button>
			<button ng-click="reset()" ng-show = "winner">reset if u want</button>
		</div>
</body>
</html>
